import requests
from time import *

# LINKS
SPOTIFY_ACCESS_TOKEN = input('Enter your token here: ')
SPOTIFY_GET_CURRENT_TRACK_URL = 'https://api.spotify.com/v1/me/player'

# CURRENT TRACK INFORMATION
def get_current_track(access_token):

    response = requests.get(
        SPOTIFY_GET_CURRENT_TRACK_URL,

        headers={
            "Authorization": f"Bearer {access_token}"
        }
    )
    resp_json = response.json()

    track_id = resp_json['item']['id']
    track_name = resp_json['item']['name']

    artists = resp_json['item']['artists']
    artists_names = ', '.join(
        [artist['name'] for artist in artists]
    )

    link = resp_json['item']['external_urls']['spotify']

    current_track_info = {
        "Id": track_id,
        "Name": track_name,
        "Artist": artists_names,
        "Link": link
    }

    # PRINT THE INFORMATION ONTO THE CONSOLE
    for key, value in current_track_info.items():
        print(key, ':', value)

    while True:
        pause_play_next_previous = input("Play | Pause | Next | Previous | Volume | Repeat: ")
        if pause_play_next_previous == "Play":
            requests.put('https://api.spotify.com/v1/me/player/play', headers={
                "Authorization": f"Bearer {access_token}"
            })

        if pause_play_next_previous == "Pause":
            requests.put('https://api.spotify.com/v1/me/player/pause', headers={
                "Authorization": f"Bearer {access_token}"
            })

        if pause_play_next_previous == "Next":
            requests.post('https://api.spotify.com/v1/me/player/next', headers={
                "Authorization": f"Bearer {access_token}"
            })

            sleep(5)
            for key, value in current_track_info.items():
                print(key, ':', value)
        if pause_play_next_previous == "Previous":
            requests.post('https://api.spotify.com/v1/me/player/previous', headers={
                "Authorization": f"Bearer {access_token}"
            })

            sleep(5)
            for key, value in current_track_info.items():
                print(key, ':', value)
        if pause_play_next_previous == "Volume":
            volume = int(input("What volume would you like?: "))
            requests.put(f'https://api.spotify.com/v1/me/player/volume?volume_percent={volume}', headers={
                "Authorization": f"Bearer {access_token}"
            })

        if pause_play_next_previous == "Repeat":
            requests.put('https://api.spotify.com/v1/me/player/repeat?state=context', headers={
                "Authorization": f"Bearer {access_token}"
            })
def main():
    current_track_info = get_current_track(
        SPOTIFY_ACCESS_TOKEN
    )
    print(current_track_info)
main()


